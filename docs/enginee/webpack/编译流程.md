---
id: webpackCompileProcess
title: webpack 编译流程
hide_title: true
sidebar_label: webpack 编译流程
---

# 流程简介

编译主流程主要经历四个阶段：

- `initial options`：初始化阶段，主要是初始化配置项，`loader`，`plugins` 等等。
- `make module`：初始化完之后，就是编译阶段，编译源代码也就是 `module`。
- `seal chunk`：编译完成之后，也就是打包优化阶段，主要就是整合 `module` 放到内存的 `chunk` 中。
- `emit assets`：打包完成之后，需要整合最后存储到文件系统中的文件，也就是 `asset`。

对应的流程图：

![webpack-compile-process](../../../static/img/webpack-process.png)

常用 `hooks` 对应的阶段：

![webpack-process](../../../static/img/webpack-process.jpeg)

# 核心对象介绍

### 1、compiler

`compiler` 是在启动的时候创建的，是全局唯一的，可以理解成 `webpack 实例`，可以拿到很多配置信息：[更多属性](https://github.com/webpack/webpack/blob/main/lib/Compiler.js#L193)

- `options`，`loaders`，`plugins` 等等配置信息。
- 读取是否是 `watch` 模式： `compiler.watchMode`
- `webpack` 对象，这个就很有用了: [更多属性](https://github.com/webpack/webpack/blob/main/lib/index.js#L549)
  - 编写插件的时候，不用安装导入 `webpack`，可以避免版本不一致导致的问题

    ```javascript
    const webpack = compiler.webpack
    ```

  - `webpack` 实例上面本身附加了很多有用的对象，避免再去安装

    ```javascript
    /** webpack-sources */
    const sources = webpack.sources
    const { RowSource } = sources

    const Template = webpack.Template
    ```
